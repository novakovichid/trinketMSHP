# SHPyIDE (Frontend Only)

## Исходная идея

Этот проект — браузерная Python‑IDE без сервера. Ключевая цель: дать пользователю опыт «открыл в браузере — сразу запускаю код», с поддержкой нескольких файлов (модулей), шаринга проекта по ссылке и библиотекой `turtle`, при этом всё должно работать на статическом хостинге вроде GitHub Pages. Поэтому состояние проекта хранится в браузере и сериализуется в URL‑hash, а выполнение Python идёт в WebAssembly через Pyodide. Это позволяет запускать код и импортировать модули в рамках одного браузерного окружения и делиться проектом без бэкенда.

## Пользовательская документация

### Быстрый старт

1. Откройте `index.html` на статическом хостинге (GitHub Pages) или локально через любой HTTP‑сервер.
2. В левом списке файлов выберите или добавьте файлы `.py`.
3. В центре отредактируйте код.
4. Нажмите **▶ Запустить** — вывод появится в секции «Вывод», а `turtle`‑рисование — в секции «Turtle».

### Вариант на Brython

`brython.html` — облегчённая версия интерфейса на Brython. В ней:

- используется одностраничный редактор `main.py` (без менеджера файлов),
- есть консоль и панель `Turtle`,
- работает шима `turtle` поверх `<canvas>`, включая базовые методы и клавиатурные события (`onkey`, `onkeypress`, `onkeyrelease`, `listen`, `mainloop`, `done`).

Если нужны большие библиотеки Python и полноценная файловая система, используйте версию на Pyodide (`index.html`).

### Работа с несколькими файлами

- **Добавить файл:** кнопка **+ Файл**.
- **Переименовать:** кнопка **Переименовать** в панели редактора.
- **Удалить:** кнопка **Удалить**.

Все файлы доступны для `import` так же, как в обычном Python‑проекте: файлы сохраняются в виртуальной файловой системе Pyodide и подхватываются интерпретатором.

### Поделиться проектом

1. Нажмите **Поделиться**.
2. Ссылка копируется в буфер обмена. Если браузер не разрешает доступ к буферу, появится окно с готовой ссылкой.
3. Открыв ссылку, другой пользователь увидит ваш проект и сможет выполнить код.

### Turtle

Проект включает браузерную реализацию `turtle`, которая рисует на `<canvas>`. Доступны основные функции: `setup`, `forward`, `backward`, `left`, `right`, `penup`, `pendown`, `goto`, `setheading`, `color`, `width`, `speed`, `clear`, `circle`, `write`.

В Brython‑варианте есть расширенная шима `turtle` с алиасами и поддержкой клавиатурных обработчиков.

## Техническая документация

### Архитектура

- **UI (Pyodide):** `index.html` + `styles.css` создают три панели — список файлов, редактор, вывод/канвас.
- **UI (Brython):** `brython.html` + `styles.css` создают редактор, `Turtle`‑панель и консоль.
- **State:** `app.js` хранит список файлов и активный файл в памяти, синхронизирует их с `localStorage`.
- **Шаринг:** состояние сериализуется в JSON, кодируется в base64 и кладётся в `location.hash`. При открытии ссылки hash парсится обратно.
- **Python runtime (Pyodide):** используем Pyodide. При запуске записываем файлы в виртуальную FS и выполняем `runpy.run_path(...)`.
- **Python runtime (Brython):** `brython-app.js` преобразует код в JS через `python_to_js`, перенаправляет `stdout`/`stderr` и подмешивает модуль `turtle`.
- **Turtle:** реализован JS‑движок `TurtleRuntime`, рисующий на `<canvas>`; модуль `turtle.py`/шима проксирует вызовы из Python в JS.

### Структура файлов

```
app.js          # логика приложения, Pyodide, turtle, шаринг
brython-app.js  # Brython-версия: запуск кода, console, turtle-шим
brython.html    # Brython UI
index.html      # базовая разметка UI
styles.css      # стили интерфейса
```

### Поток запуска (Pyodide)

1. Пользователь нажимает **Запустить**.
2. Сохраняется текущий файл.
3. Загружается Pyodide (если ещё не загружен).
4. Файлы проекта записываются в FS Pyodide.
5. Исполняется `main.py` (или активный файл, если `main.py` нет).
6. Логи идут в «Вывод», turtle‑рисование — в `<canvas>`.

### Поток запуска (Brython)

1. Пользователь нажимает **▶ Запуск**.
2. Код берётся из редактора, подмешиваются `stdout`‑редирект и модуль `turtle`.
3. Код транслируется через `python_to_js` и выполняется в браузере.
4. Логи идут в «Консоль», turtle‑рисование — в `<canvas>`.

### Безопасность и ограничения

- Нет бэкенда: всё выполняется в браузере пользователя.
- Размер URL ограничен длиной hash — очень большие проекты в ссылку могут не поместиться.
- Pyodide/Brython загружаются из CDN, требуется доступ к сети при первом запуске.
